# Flow Planner

<div align="center">
  <img src="static\images\Title.png" alt="Flow Planner Banner" width="70%">
  <p><em>Image generated by <a href="https://aistudio.google.com/app/prompts/new_chat">Nano-banana</a></em></p>
</div>

<div align="center">
  
  [![Browser-Use](https://img.shields.io/badge/Powered%20by-Browser--Use-blue?style=for-the-badge&logo=github)](https://github.com/browser-use/browser-use)
  [![Website](https://img.shields.io/badge/Website-browser--use.com-green?style=for-the-badge&logo=google-chrome)](https://browser-use.com)
  [![Demo](https://img.shields.io/badge/Demo-Live-orange?style=for-the-badge&logo=youtube)](https://your-demo-link.com)
  [![License](https://img.shields.io/badge/License-MIT-yellow?style=for-the-badge)](LICENSE)
  
</div>

---

An AI-powered autonomous system that captures and documents step-by-step UI workflows for any web application. Powered by Browser-Use framework with Claude Sonnet 4.5 vision and Gemini planning.

## Features

- **Autonomous Navigation**: Browser-Use agent navigates UIs without pre-programmed selectors
- **Smart Planning**: Gemini detects authentication requirements and creates workflow outlines
- **Vision + DOM**: Claude Sonnet 4.5 combines visual and structural understanding
- **Persistent Auth**: Saved browser profiles for seamless authentication
- **State Capture**: Automatic screenshot and metadata extraction

## System Architecture

```
Gemini Planner ‚Üí Browser-Use Agent ‚Üí State Capturer
     ‚Üì                  ‚Üì                  ‚Üì
Auth detection    Autonomous        Screenshots +
+ workflow        navigation        Metadata
```

**Browser-Use Framework**: Uses perception-cognition-action loop for dynamic UI adaptation

## Setup

### 1. Install Dependencies

```bash
# Create virtual environment
python -m venv venv

# Activate virtual environment
# Windows:
venv\Scripts\activate
# macOS/Linux:
source venv/bin/activate

# Install packages
pip install -r requirements.txt

# Install Playwright browser
playwright install chromium
```

### 2. Configure Environment

Copy `.env-template` to `.env` and add your API keys:

```bash
# API Keys
GEMINI_API_KEY=your-gemini-key-here
ANTHROPIC_API_KEY=your-anthropic-key-here

# Browser-Use Settings
BROWSER_USE_MAX_STEPS=50
BROWSER_USE_LLM_MODEL=claude-sonnet-4-5-20250929

# Authentication (optional - for Tier 2 auto-login)
DEFAULT_EMAIL=your.email@example.com
DEFAULT_PASSWORD=your_password

# Browser Settings
HEADLESS_BROWSER=false
USE_PERSISTENT_CONTEXT=true
```

**Get API Keys:**
- **Gemini**: https://aistudio.google.com/app/apikey (Free)
- **Anthropic**: https://console.anthropic.com/ ($5 free credit)

### 3. Verify Setup

```bash
python verify_setup.py
```

You should see all checks pass with `[OK] PASSED` status.

## Usage

### Quick Start - Predefined Tasks

Run workflow capture with predefined test cases:

```bash
python run_workflow.py --predefined
```

This will test:
- Wikipedia search
- YouTube homepage
- Google search
- GitHub browsing

### Custom Workflow

Run interactive mode to capture your own workflow:

```bash
python run_workflow.py
```

You'll be prompted for:
- Task description (e.g., "Search for Python tutorials")
- Application URL (e.g., "https://www.google.com")
- Application name (e.g., "Google")

### Comprehensive Testing

Run the full test suite:

```bash
python test_browser_use.py
```

Tests include:
1. Simple navigation (no auth)
2. Planner auth detection (3 test cases)

## Output Structure

Each workflow capture creates:

```
output/
‚îî‚îÄ‚îÄ {task_name}_{timestamp}/
    ‚îú‚îÄ‚îÄ metadata.json          # Workflow data
    ‚îú‚îÄ‚îÄ screenshot_001.png     # State screenshots
    ‚îú‚îÄ‚îÄ screenshot_002.png
    ‚îî‚îÄ‚îÄ ...
```

## Project Structure

```
Flow-Planner/
‚îú‚îÄ‚îÄ agent/
‚îÇ   ‚îú‚îÄ‚îÄ planner.py              # Gemini workflow planner
‚îÇ   ‚îú‚îÄ‚îÄ browser_use_agent.py    # Browser-Use wrapper
‚îÇ   ‚îú‚îÄ‚îÄ state_capturer.py       # State extraction
‚îÇ   ‚îî‚îÄ‚îÄ authenticator.py        # 3-tier auth handler
‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îî‚îÄ‚îÄ logger.py               # Logging configuration
‚îú‚îÄ‚îÄ output/                     # Captured workflows
‚îú‚îÄ‚îÄ logs/                       # Application logs
‚îú‚îÄ‚îÄ config.py                   # Configuration management
‚îú‚îÄ‚îÄ run_workflow.py             # Quick workflow capture
‚îú‚îÄ‚îÄ test_browser_use.py         # Comprehensive test suite
‚îú‚îÄ‚îÄ verify_setup.py             # Setup verification
‚îî‚îÄ‚îÄ requirements.txt            # Dependencies
```

## How It Works

### 1. Planning Phase
- Gemini analyzes the task
- Detects authentication requirements
- Creates high-level workflow outline

### 2. Execution Phase
- Browser-Use agent navigates autonomously
- Claude Sonnet 4.5 analyzes screenshots + DOM
- Adapts to dynamic content in real-time
- No CSS selectors needed

### 3. Capture Phase
- Extracts screenshots from execution history
- Saves structured metadata
- Organizes output by task

## Authentication

**3-Tier Strategy:**

1. **Tier 1**: Persistent browser profile (automatic)
   - Saved cookies and sessions
   - No manual login required for returning users

2. **Tier 2**: Browser-Use auto-login (optional)
   - Uses DEFAULT_EMAIL and DEFAULT_PASSWORD from .env
   - Agent automatically handles login forms

3. **Tier 3**: Manual login (fallback)
   - Pauses for user to login manually
   - Configurable timeout

## Cost Estimate

Per workflow (typical 5-10 steps):
- Gemini Flash: $0.00 (Free tier)
- Browser-Use: $0.00 (Open source)
- Claude Sonnet 4.5: ~$0.02-0.05
- **Total**: ~$0.02-0.05 per workflow

## Troubleshooting

### "Configuration error: ANTHROPIC_API_KEY is not set"
- Copy `.env-template` to `.env`
- Add your API keys

### "Browser launch failed"
- Run `playwright install chromium`
- Check disk space

### "'ChatAnthropic' object has no attribute 'model_name'"
- This is fixed in the latest version
- Ensure you're using the updated browser_use_agent.py

### Agent execution fails
- Check logs in `logs/app.log`
- Set `HEADLESS_BROWSER=false` to see browser
- Verify API keys are valid

## Documentation

- [SYSTEM_OVERVIEW.md](SYSTEM_OVERVIEW.md) - Architecture and data flow
- [IMPLEMENTATION_SUCCESS.md](IMPLEMENTATION_SUCCESS.md) - Implementation details
- [BROWSER_USE_IMPLEMENTATION.md](BROWSER_USE_IMPLEMENTATION.md) - Usage guide
- [CLEANUP_SUMMARY.md](CLEANUP_SUMMARY.md) - Recent cleanup changes

## Test Status

- [OK] Simple Navigation Test
- [OK] Planner Auth Detection (3/3 cases)
- [READY] Authentication Flow Test

## üåê Deployment

### Deploy to Railway (Recommended)

Railway provides full support for WebSockets, background jobs, and browser automation.

[![Deploy on Railway](https://railway.app/button.svg)](https://railway.app/new/template?template=https://github.com/PranavMishra17/Flow-Planner)

**Quick Deploy:**
1. Click the button above or go to [Railway Dashboard](https://railway.app/new)
2. Select "Deploy from GitHub repo"
3. Choose `Flow-Planner` repository
4. Add environment variables (see configuration above)
5. Click "Deploy"

**Full deployment guide:** [RAILWAY_DEPLOYMENT.md](RAILWAY_DEPLOYMENT.md)

### Other Platforms

- **Render:** [DEPLOYMENT.md](DEPLOYMENT.md#render-deployment)
- **Heroku:** [DEPLOYMENT.md](DEPLOYMENT.md#heroku-deployment)
- **Docker:** [DEPLOYMENT.md](DEPLOYMENT.md#docker-deployment)

---

## License

See [LICENSE](LICENSE) file for details.


## Connect with me

<table align="center">
<tr>
<td width="200px">
  <img src="static/images/me.png" alt="Pranav Mishra" width="180" style="border: 5px solid; border-image: linear-gradient(45deg, #9d4edd, #ff006e) 1;">
</td>
<td>
  
[![Portfolio](https://img.shields.io/badge/-Portfolio-000?style=for-the-badge&logo=vercel&logoColor=white)](https://portfolio-pranav-mishra-paranoid.vercel.app)
[![LinkedIn](https://img.shields.io/badge/-LinkedIn-0A66C2?style=for-the-badge&logo=linkedin&logoColor=white)](https://www.linkedin.com/in/pranavgamedev/)
[![Resume](https://img.shields.io/badge/-Resume-4B0082?style=for-the-badge&logo=read-the-docs&logoColor=white)](https://portfolio-pranav-mishra-paranoid.vercel.app/resume)
[![YouTube](https://img.shields.io/badge/-YouTube-8B0000?style=for-the-badge&logo=youtube&logoColor=white)](https://www.youtube.com/@parano1dgames/featured)
[![Hugging Face](https://img.shields.io/badge/-Hugging%20Face-FFD21E?style=for-the-badge&logo=huggingface&logoColor=black)](https://huggingface.co/Paranoiid)

</td>
</tr>
</table>
